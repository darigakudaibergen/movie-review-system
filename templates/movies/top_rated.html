{% extends 'movies/base.html' %}

{% block title %}Top Rated Movies{% endblock %}

{% block content %}
<div class="container">
    <div class="top-rated-header">
        <h1>üèÜ Top Rated Movies</h1>
        <p>The highest rated movies based on user reviews</p>
    </div>

    <div class="top-rated-list">
        {% if movies_with_ratings %}
            {% for item in movies_with_ratings %}
                <div class="top-movie-card">
                    <div class="rank-badge">
                        #{{ forloop.counter }}
                    </div>
                    
                    <div class="movie-poster-small">
                        {% if item.movie.poster_url %}
                            <img src="{{ item.movie.poster_url }}" alt="{{ item.movie.title }}">
                        {% else %}
                            <div class="poster-placeholder-small">üé¨</div>
                        {% endif %}
                    </div>
                    
                    <div class="movie-info-inline">
                        <h3>{{ item.movie.title }}</h3>
                        <p class="movie-meta">
                            {{ item.movie.release_year }} ‚Ä¢ {{ item.movie.director }}
                            {% if item.movie.genre %}
                                ‚Ä¢ <span class="genre-badge">{{ item.movie.genre.name }}</span>
                            {% endif %}
                        </p>
                        <p class="movie-description">{{ item.movie.description|truncatewords:15 }}</p>
                    </div>
                    
                    <div class="rating-column">
                        <div class="stars-medium">
                            {% for i in "12345" %}
                                {% if forloop.counter <= item.avg_rating %}
                                    ‚òÖ
                                {% else %}
                                    ‚òÜ
                                {% endif %}
                            {% endfor %}
                        </div>
                        <p class="rating-score">{{ item.avg_rating }}/5</p>
                        <p class="review-count">{{ item.review_count }} review{{ item.review_count|pluralize }}</p>
                        <a href="{% url 'movie_detail' item.movie.id %}" class="btn btn-small">View</a>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="no-results">
                <h2>No rated movies yet</h2>
                <p>Be the first to review a movie!</p>
                <a href="{% url 'home' %}" class="btn btn-primary">Browse Movies</a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
